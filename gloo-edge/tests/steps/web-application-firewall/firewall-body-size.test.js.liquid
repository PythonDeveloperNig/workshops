var chai = require('chai');
var expect = chai.expect;
const chaiHttp = require("chai-http");
chai.use(chaiHttp);

process.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';

let searchTest="Payload sizes above 1KB not allowed";

describe("Request should be blocked due to the body size", () => {
  it("Request is blocked", async () => {
    await chai.request(process.env.APP_URL)
      .post('/not-secured/post')
      .send("<note><heading>Reminder</heading><body>are you sure this is a huge payload???</body></note>")
      .then((res) => {
        expect(res.text).to.contain(searchTest);
      });
  });
});
